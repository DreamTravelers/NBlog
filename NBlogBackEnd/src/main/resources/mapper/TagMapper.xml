<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.zxqax.nblog.dao.TagDao">

    <sql id="TABLE_ARTICLE">
        <include refid="com.zxqax.nblog.dao.ArticleDao.BASE_TABLE" />
    </sql>

    <sql id="TABLE_USER_INFO">
        <include refid="com.zxqax.nblog.dao.UserDao.BASE_TABLE" />
    </sql>

    <select id="getTags" resultType="java.lang.String">
        SELECT
            a.article_tags
        FROM
            <include refid="TABLE_ARTICLE" /> as a
        WHERE
            a.is_delete = 0 and a.status = 1
    </select>
    <select id="getTagArticleData" resultType="com.zxqax.nblog.dto.TagArticleDTO">
        SELECT
            a.id,
            a.user_id,
            u.`name` author,
            a.article_title title,
            a.article_desc content,
            a.article_tags tags,
            a.create_time,
            a.img
        FROM
            <include refid="TABLE_ARTICLE" /> as a ,
            <include refid="TABLE_USER_INFO" /> as u
        WHERE
            a.`status` = 1 and a.is_delete = 0 and a.user_id=u.id and a.article_tags LIKE CONCAT('%',#{tagname},'%')
        ORDER BY a.id desc
    </select>

</mapper>